<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶£å‘³é…¸é¹¼é…å°æŒ‘æˆ°</title>
    <style>
        :root {
            --bg-color: #eef2f7;
            --card-back: linear-gradient(135deg, #6e8efb, #a777e3);
            --acid-color: #ff5e62;
            --alkali-color: #00b09b;
            --neutral-color: #bdc3c7;
        }

        body {
            font-family: 'PingFang HK', 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 { color: #2c3e50; margin-top: 20px; text-shadow: 1px 1px 2px white; }

        .ui-panel {
            background: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .game-board {
            display: grid;
            gap: 15px;
            perspective: 1000px;
            margin-bottom: 40px;
        }

        /* å¡ç‰Œå°ºå¯¸åŠ å¤§ç´„å…©å€ */
        .card {
            width: 140px;
            height: 180px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .card.flipped { transform: rotateY(180deg); }

        .card.matched {
            animation: matchAnim 0.5s forwards;
            pointer-events: none;
        }

        @keyframes matchAnim {
            0% { transform: rotateY(180deg) scale(1); opacity: 1; }
            50% { transform: rotateY(180deg) scale(1.1); opacity: 1; }
            100% { transform: rotateY(180deg) scale(0); opacity: 0; }
        }

        .card.shake { animation: shake 0.4s; }
        @keyframes shake {
            0%, 100% { transform: translateX(0) rotateY(180deg); }
            25% { transform: translateX(-10px) rotateY(180deg); }
            75% { transform: translateX(10px) rotateY(180deg); }
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            border: 4px solid white;
        }

        /* å¡èƒŒè¨­è¨ˆ */
        .card-front {
            background: var(--card-back);
            color: white;
            font-size: 3rem;
        }

        .card-front::after {
            content: "ğŸ§ª";
            opacity: 0.3;
        }

        /* å¡é¢è¨­è¨ˆ */
        .card-back {
            background: white;
            transform: rotateY(180deg);
            padding: 10px;
            text-align: center;
        }

        .emoji { font-size: 2.5rem; margin-bottom: 10px; }
        .text-en { font-size: 1.1rem; font-weight: bold; color: #333; }
        .text-cn { font-size: 1.4rem; font-weight: 900; color: #000; margin-top: 5px; }
        
        .tag {
            margin-top: auto;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            color: white;
            font-weight: bold;
        }

        .type-acidic .tag { background: var(--acid-color); }
        .type-alkaline .tag { background: var(--alkali-color); }
        .type-neutral .tag { background: var(--neutral-color); }

        select, button {
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #ddd;
            font-size: 1rem;
            outline: none;
        }

        button {
            background: #4a90e2;
            color: white;
            border: none;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover { background: #357abd; }

        .stat-val { font-weight: bold; color: #4a90e2; font-size: 1.2rem; }
    </style>
</head>
<body>

    <h1>ğŸŒŸ é…¸é¹¼ç‰©è³ªå¤§æœç´¢</h1>

    <div class="ui-panel">
        <div>
            é›£åº¦ï¼š
            <select id="difficulty">
                <option value="2x2">2 x 2 (è¼•é¬†)</option>
                <option value="3x4">3 x 4 (é€²éš)</option>
                <option value="4x4" selected>4 x 4 (æŒ‘æˆ°)</option>
            </select>
        </div>
        <div>â±ï¸ <span id="timer" class="stat-val">0</span>s</div>
        <button onclick="startGame()">é‡æ–°é–‹å§‹</button>
    </div>

    <div class="game-board" id="gameBoard"></div>

    <script>
        const substances = [
            { name: "Orange", cn: "æ©™", type: "acidic", icon: "ğŸŠ" },
            { name: "Lemon", cn: "æª¸æª¬", type: "acidic", icon: "ğŸ‹" },
            { name: "Soft Drinks", cn: "æ±½æ°´", type: "acidic", icon: "ğŸ¥¤" },
            { name: "Kiwi Fruit", cn: "å¥‡ç•°æœ", type: "acidic", icon: "ğŸ¥" },
            { name: "Yoghurt", cn: "ä¹³é…ª", type: "acidic", icon: "ğŸ¦" },
            { name: "Vinegar", cn: "é†‹", type: "acidic", icon: "ğŸ¶" },
            { name: "Hair Conditioner", cn: "è­·é«®ç´ ", type: "acidic", icon: "ğŸ§´" },
            { name: "Lotion", cn: "æ½¤è†šéœ²", type: "acidic", icon: "ğŸ§¼" },
            { name: "Toilet Cleaner", cn: "æ½”å»åŠ‘", type: "acidic", icon: "ğŸš½" },
            { name: "Lye Rice Dumplings", cn: "é¹¼æ°´ç²½", type: "alkaline", icon: "ğŸ™" },
            { name: "Baking Soda", cn: "æ¢³æ‰“ç²‰", type: "alkaline", icon: "ğŸ" },
            { name: "Preserved Eggs", cn: "çš®è›‹", type: "alkaline", icon: "ğŸ¥š" },
            { name: "Chinese Noodles", cn: "ä¸­å¼éºµæ¢", type: "alkaline", icon: "ğŸœ" },
            { name: "Alkaline Batteries", cn: "é¹¼æ€§é›»æ± ", type: "alkaline", icon: "ğŸ”‹" },
            { name: "Kitchen Cleaner", cn: "å»šæˆ¿æ¸…æ½”åŠ‘", type: "alkaline", icon: "ğŸ§¼" },
            { name: "Bleach", cn: "æ¼‚ç™½æ°´", type: "alkaline", icon: "ğŸ§ª" },
            { name: "Toothpaste", cn: "ç‰™è†", type: "alkaline", icon: "ğŸª¥" },
            { name: "Soap", cn: "è‚¥çš‚", type: "alkaline", icon: "ğŸ§¼" },
            { name: "Hydrochloric Acid", cn: "æ°«æ°¯é…¸", type: "acidic", icon: "ğŸ§ª" },
            { name: "Distilled Water", cn: "è’¸é¤¾æ°´", type: "neutral", icon: "ğŸ’§" }
        ];

        let flippedCards = [];
        let matchedCount = 0;
        let timerInterval;
        let seconds = 0;
        let isLockBoard = false;

        function startGame() {
            const diff = document.getElementById('difficulty').value;
            let cols, rows;
            
            if (diff === '2x2') { cols = 2; rows = 2; }
            else if (diff === '3x4') { cols = 3; rows = 4; }
            else { cols = 4; rows = 4; }

            const totalCards = cols * rows;
            const numPairs = totalCards / 2;

            // é‡ç½®
            clearInterval(timerInterval);
            seconds = 0;
            matchedCount = 0;
            flippedCards = [];
            isLockBoard = false;
            document.getElementById('timer').innerText = '0';
            
            const selected = [...substances].sort(() => 0.5 - Math.random()).slice(0, numPairs);
            let gameCards = [];
            selected.forEach((item, idx) => {
                gameCards.push({ ...item, text: item.name, pairId: idx });
                gameCards.push({ ...item, text: item.cn, pairId: idx });
            });
            gameCards.sort(() => 0.5 - Math.random());

            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            board.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

            gameCards.forEach(data => {
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.pairId = data.pairId;
                card.innerHTML = `
                    <div class="card-face card-front"></div>
                    <div class="card-face card-back type-${data.type}">
                        <div class="emoji">${data.icon}</div>
                        <div class="${/[\u4e00-\u9fa5]/.test(data.text) ? 'text-cn' : 'text-en'}">${data.text}</div>
                        <div class="tag">${data.type.toUpperCase()}</div>
                    </div>
                `;
                card.onclick = flipCard;
                board.appendChild(card);
            });

            timerInterval = setInterval(() => {
                seconds++;
                document.getElementById('timer').innerText = seconds;
            }, 1000);
        }

        function flipCard() {
            if (isLockBoard || this.classList.contains('flipped')) return;

            this.classList.add('flipped');
            flippedCards.push(this);

            if (flippedCards.length === 2) {
                isLockBoard = true;
                const [c1, c2] = flippedCards;
                if (c1.dataset.pairId === c2.dataset.pairId) {
                    setTimeout(() => {
                        c1.classList.add('matched');
                        c2.classList.add('matched');
                        matchedCount++;
                        flippedCards = [];
                        isLockBoard = false;
                        checkWin();
                    }, 600);
                } else {
                    setTimeout(() => {
                        c1.classList.add('shake');
                        c2.classList.add('shake');
                        setTimeout(() => {
                            c1.classList.remove('flipped', 'shake');
                            c2.classList.remove('flipped', 'shake');
                            flippedCards = [];
                            isLockBoard = false;
                        }, 500);
                    }, 600);
                }
            }
        }

        function checkWin() {
            const diff = document.getElementById('difficulty').value;
            const totalPairs = (parseInt(diff[0]) * parseInt(diff[2])) / 2;
            if (matchedCount === totalPairs) {
                clearInterval(timerInterval);
                setTimeout(() => alert(`ğŸ‰ å¤ªæ£’äº†ï¼ä½ åœ¨ ${seconds} ç§’å…§å®Œæˆäº†æŒ‘æˆ°ï¼`), 500);
            }
        }

        window.onload = startGame;
    </script>
</body>
</html>